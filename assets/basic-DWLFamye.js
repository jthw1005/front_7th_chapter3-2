import{r as d,j as e,R as ee,a as se}from"./client-DvaAtPIX.js";function te(s,t){const[r,n]=d.useState(s);return d.useEffect(()=>{const c=setTimeout(()=>{n(s)},t);return()=>clearTimeout(c)},[s,t]),r}function L(s,t){const[r,n]=d.useState(()=>{try{const m=localStorage.getItem(s);return m?JSON.parse(m):t}catch{return t}}),c=d.useCallback(m=>{n(h=>m instanceof Function?m(h):m)},[]);return d.useEffect(()=>{try{r==null||Array.isArray(r)&&r.length===0?localStorage.removeItem(s):localStorage.setItem(s,JSON.stringify(r))}catch{throw new Error("localStorage 저장 실패")}},[s,r]),[r,c]}const re=(s,t)=>{const{discounts:r}=s.product,{quantity:n}=s,c=r.reduce((h,f)=>n>=f.quantity&&f.rate>h?f.rate:h,0);return t.some(h=>h.quantity>=10)?Math.min(c+.05,.5):c},W=(s,t)=>{const{price:r}=s.product,{quantity:n}=s,c=re(s,t);return Math.round(r*n*(1-c))},B=(s,t)=>{let r=0,n=0;return s.forEach(c=>{const m=c.product.price*c.quantity;r+=m,n+=W(c,s)}),t&&(t.discountType==="amount"?n=Math.max(0,n-t.discountValue):n=Math.round(n*(1-t.discountValue/100))),{totalBeforeDiscount:Math.round(r),totalAfterDiscount:Math.round(n)}},ne=(s,t)=>{const r=t.find(n=>n.product.id===s.id);return s.stock-(r?.quantity||0)};function ae(s){const[t,r]=L("cart",[]),[n,c]=d.useState(null),m=d.useCallback(i=>ne(i,t),[t]),h=d.useCallback(i=>W(i,t),[t]),f=d.useCallback(()=>B(t,n),[t,n]),x=d.useCallback(i=>m(i)<=0?{success:!1,message:"재고가 부족합니다!"}:(r(p=>{const N=p.find(C=>C.product.id===i.id);if(N){const C=N.quantity+1;return C>i.stock?p:p.map(k=>k.product.id===i.id?{...k,quantity:C}:k)}return[...p,{product:i,quantity:1}]}),{success:!0,message:"장바구니에 담았습니다"}),[m,r]),b=d.useCallback(i=>{r(o=>o.filter(p=>p.product.id!==i))},[r]),l=d.useCallback((i,o)=>{if(o<=0)return b(i),{success:!0};const p=s.find(C=>C.id===i);if(!p)return{success:!1};const N=p.stock;return o>N?{success:!1,message:`재고는 ${N}개까지만 있습니다.`}:(r(C=>C.map(k=>k.product.id===i?{...k,quantity:o}:k)),{success:!0})},[s,b,r]),u=d.useCallback(i=>B(t,null).totalAfterDiscount<1e4&&i.discountType==="percentage"?{success:!1,message:"percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다."}:(c(i),{success:!0,message:"쿠폰이 적용되었습니다."}),[t]),y=d.useCallback(()=>{c(null)},[]),j=d.useCallback(()=>{r([]),c(null)},[r]),g=t.reduce((i,o)=>i+o.quantity,0);return{cart:t,selectedCoupon:n,totalItemCount:g,addToCart:x,removeFromCart:b,updateQuantity:l,applyCoupon:u,clearCoupon:y,clearCart:j,calculateItemTotal:h,calculateCartTotal:f,getRemainingStock:m}}const V=9999,q=1e5,ce=3e3,oe=500,le=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],de=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],A={name:"",price:0,stock:0,description:"",discounts:[]},X={name:"",code:"",discountType:"amount",discountValue:0},ie={quantity:10,rate:.1},D={PRODUCT_ADDED:"상품이 추가되었습니다.",PRODUCT_UPDATED:"상품이 수정되었습니다.",PRODUCT_DELETED:"상품이 삭제되었습니다.",COUPON_ADDED:"쿠폰이 추가되었습니다.",COUPON_DELETED:"쿠폰이 삭제되었습니다.",DUPLICATE_COUPON_CODE:"이미 존재하는 쿠폰 코드입니다.",PRICE_MUST_BE_POSITIVE:"가격은 0보다 커야 합니다",STOCK_MUST_BE_POSITIVE:"재고는 0보다 커야 합니다",STOCK_EXCEEDS_MAX:"재고는 9999개를 초과할 수 없습니다",DISCOUNT_RATE_EXCEEDS_MAX:"할인율은 100%를 초과할 수 없습니다",DISCOUNT_AMOUNT_EXCEEDS_MAX:"할인 금액은 100,000원을 초과할 수 없습니다"};function U(){const[s,t]=L("products",le),r=d.useCallback(x=>{const b={...x,id:`p${Date.now()}`};t(l=>[...l,b])},[t]),n=d.useCallback((x,b)=>{t(l=>l.map(u=>u.id===x?{...u,...b}:u))},[t]),c=d.useCallback(x=>{t(b=>b.filter(l=>l.id!==x))},[t]),m=d.useCallback((x,b)=>{n(x,{stock:b})},[n]),h=d.useCallback((x,b)=>{t(l=>l.map(u=>u.id===x?{...u,discounts:[...u.discounts,b]}:u))},[t]),f=d.useCallback((x,b)=>{t(l=>l.map(u=>u.id===x?{...u,discounts:u.discounts.filter((y,j)=>j!==b)}:u))},[t]);return{products:s,addProduct:r,updateProduct:n,deleteProduct:c,updateProductStock:m,addProductDiscount:h,removeProductDiscount:f}}function $(){const[s,t]=L("coupons",de),r=d.useCallback(c=>s.find(h=>h.code===c.code)?!1:(t(h=>[...h,c]),!0),[s,t]),n=d.useCallback(c=>{t(m=>m.filter(h=>h.code!==c))},[t]);return{coupons:s,addCoupon:r,removeCoupon:n}}function ue(){return e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})}function me(){return e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}function xe(){return e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}function he(){return e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}function ge(){return e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}function R(){return e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function pe(){return e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}const E=(s,t=!0)=>{const r=s.toLocaleString("ko-KR");return t?r+"원":r},be=s=>"₩"+s.toLocaleString("ko-KR"),F=s=>Math.round(s*100)+"%",fe=(s,t)=>s==="amount"?E(t)+" 할인":t+"% 할인",ye=()=>"ORD-"+Date.now();function je({product:s,remainingStock:t,formatPrice:r,onAddToCart:n}){return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx(pe,{})}),s.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),s.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",F(Math.max(...s.discounts.map(c=>c.rate)))]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:r(s.price,s.id)}),s.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[s.discounts[0].quantity,"개 이상 구매시 할인"," ",F(s.discounts[0].rate)]})]}),e.jsxs("div",{className:"mb-3",children:[t<=5&&t>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",t,"개 남음"]}),t>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",t,"개"]})]}),e.jsx("button",{onClick:()=>n(s),disabled:t<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${t<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:t<=0?"품절":"장바구니 담기"})]})]})}function Ne({products:s,getRemainingStock:t,formatPrice:r,onAddToCart:n}){return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(c=>e.jsx(je,{product:c,remainingStock:t(c),formatPrice:r,onAddToCart:n},c.id))})}function Ce({searchTerm:s}){return e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',s,'"에 대한 검색 결과가 없습니다.']})})}const ve=(s,t)=>{if(!t.trim())return s;const r=t.toLowerCase();return s.filter(n=>n.name.toLowerCase().includes(r)||n.description&&n.description.toLowerCase().includes(r))};function we({cart:s,coupons:t,selectedCoupon:r,totals:n,calculateItemTotal:c,onRemoveFromCart:m,onUpdateQuantity:h,onApplyCoupon:f,onClearCoupon:x,onCompleteOrder:b}){return e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(me,{}),"장바구니"]}),s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:s.map(l=>{const u=c(l),y=l.product.price*l.quantity,j=u<y,g=j?Math.round((1-u/y)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:l.product.name}),e.jsx("button",{onClick:()=>m(l.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx(R,{})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>h(l.product.id,l.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:l.quantity}),e.jsx("button",{onClick:()=>h(l.product.id,l.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[j&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",g,"%"]}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:E(Math.round(u))})]})]})]},l.product.id)})})]}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),t.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:r?.code||"",onChange:l=>{const u=t.find(y=>y.code===l.target.value);u?f(u):x()},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map(l=>e.jsxs("option",{value:l.code,children:[l.name," (",l.discountType==="amount"?E(l.discountValue,!1):`${l.discountValue}%`,")"]},l.code))]})]}),e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsx("span",{className:"font-medium",children:E(n.totalBeforeDiscount)})]}),n.totalBeforeDiscount-n.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",E(n.totalBeforeDiscount-n.totalAfterDiscount)]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsx("span",{className:"font-bold text-lg text-gray-900",children:E(n.totalAfterDiscount)})]})]}),e.jsxs("button",{onClick:b,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[E(n.totalAfterDiscount)," 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})]})]})}function ke({searchTerm:s,onNotification:t,cart:r,selectedCoupon:n,addToCart:c,removeFromCart:m,updateQuantity:h,applyCoupon:f,clearCoupon:x,clearCart:b,calculateItemTotal:l,calculateCartTotal:u,getRemainingStock:y}){const{products:j}=U(),{coupons:g}=$(),i=(w,v)=>{if(v){const T=j.find(O=>O.id===v);if(T&&y(T)<=0)return"SOLD OUT"}return be(w)},o=d.useCallback(w=>{const v=c(w);v.message&&t(v.message,v.success?"success":"error")},[c,t]),p=d.useCallback(w=>{m(w)},[m]),N=d.useCallback((w,v)=>{const T=h(w,v);!T.success&&T.message&&t(T.message,"error")},[h,t]),C=d.useCallback(w=>{const v=f(w);v.message&&t(v.message,v.success?"success":"error")},[f,t]),k=d.useCallback(()=>{const w=ye();t("주문이 완료되었습니다. 주문번호: "+w,"success"),b()},[t,b]),P=u(),S=ve(j,s);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",j.length,"개 상품"]})]}),S.length===0?e.jsx(Ce,{searchTerm:s}):e.jsx(Ne,{products:S,getRemainingStock:y,formatPrice:i,onAddToCart:o})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(we,{cart:r,coupons:g,selectedCoupon:n,totals:P,calculateItemTotal:l,onRemoveFromCart:p,onUpdateQuantity:N,onApplyCoupon:C,onClearCoupon:x,onCompleteOrder:k})})]})}const M=s=>{if(s==="")return 0;const t=parseInt(s,10);return isNaN(t)?0:t},I=s=>s===""||/^\d+$/.test(s);function Te({editingProduct:s,productForm:t,onSubmit:r,onCancel:n,onNameChange:c,onDescriptionChange:m,onPriceChange:h,onPriceBlur:f,onStockChange:x,onStockBlur:b,onDiscountsChange:l}){const u=(g,i,o)=>{const p=[...t.discounts];p[g]={...p[g],[i]:o},l(p)},y=()=>{l([...t.discounts,ie])},j=g=>{l(t.discounts.filter((i,o)=>o!==g))};return e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:t.name,onChange:g=>c(g.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:t.description,onChange:g=>m(g.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:t.price===0?"":t.price,onChange:g=>h(g.target.value),onBlur:g=>f(g.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:t.stock===0?"":t.stock,onChange:g=>x(g.target.value),onBlur:g=>b(g.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[t.discounts.map((g,i)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:g.quantity,onChange:o=>u(i,"quantity",parseInt(o.target.value)||0),className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:g.rate*100,onChange:o=>u(i,"rate",(parseInt(o.target.value)||0)/100),className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>j(i),className:"text-red-600 hover:text-red-800",children:e.jsx(R,{})})]},i)),e.jsx("button",{type:"button",onClick:y,className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:s==="new"?"추가":"수정"})]})]})})}function De({products:s,showProductForm:t,editingProduct:r,productForm:n,onStartAdd:c,onStartEdit:m,onDelete:h,onSubmit:f,onCancel:x,onNameChange:b,onDescriptionChange:l,onPriceChange:u,onPriceBlur:y,onStockChange:j,onStockBlur:g,onDiscountsChange:i}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E(o.price)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(o.stock>10?"bg-green-100 text-green-800":o.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:[o.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:o.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>m(o),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>h(o.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},o.id))})]})}),t&&e.jsx(Te,{editingProduct:r,productForm:n,onSubmit:f,onCancel:x,onNameChange:b,onDescriptionChange:l,onPriceChange:u,onPriceBlur:y,onStockChange:j,onStockBlur:g,onDiscountsChange:i})]})}function Se({coupon:s,onDelete:t}){return e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:s.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:fe(s.discountType,s.discountValue)})})]}),e.jsx("button",{onClick:()=>t(s.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx(ge,{})})]})})}function Ee({couponForm:s,onSubmit:t,onCancel:r,onNameChange:n,onCodeChange:c,onTypeChange:m,onValueChange:h,onValueBlur:f}){return e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:s.name,onChange:x=>n(x.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:s.code,onChange:x=>c(x.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:s.discountType,onChange:x=>m(x.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:s.discountValue===0?"":s.discountValue,onChange:x=>h(x.target.value),onBlur:f,className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:s.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})}function Pe({coupons:s,showCouponForm:t,couponForm:r,onToggleForm:n,onDelete:c,onSubmit:m,onCancel:h,onNameChange:f,onCodeChange:x,onTypeChange:b,onValueChange:l,onValueBlur:u}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[s.map(y=>e.jsx(Se,{coupon:y,onDelete:c},y.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx(he,{}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),t&&e.jsx(Ee,{couponForm:r,onSubmit:m,onCancel:h,onNameChange:f,onCodeChange:x,onTypeChange:b,onValueChange:l,onValueBlur:u})]})]})}function Oe({onNotification:s}){const{products:t,addProduct:r,updateProduct:n,deleteProduct:c}=U(),{coupons:m,addCoupon:h,removeCoupon:f}=$(),[x,b]=d.useState("products"),[l,u]=d.useState(!1),[y,j]=d.useState(!1),[g,i]=d.useState(null),[o,p]=d.useState(A),[N,C]=d.useState(X),k=d.useCallback(a=>{r(a),s(D.PRODUCT_ADDED,"success")},[r,s]),P=d.useCallback((a,_)=>{n(a,_),s(D.PRODUCT_UPDATED,"success")},[n,s]),S=d.useCallback(a=>{c(a),s(D.PRODUCT_DELETED,"success")},[c,s]),w=d.useCallback(a=>{h(a)?s(D.COUPON_ADDED,"success"):s(D.DUPLICATE_COUPON_CODE,"error")},[h,s]),v=d.useCallback(a=>{f(a),s(D.COUPON_DELETED,"success")},[f,s]),T=a=>{a.preventDefault(),g&&g!=="new"?P(g,o):k({...o,discounts:o.discounts}),p({...A,discounts:[]}),i(null),u(!1)},O=a=>{a.preventDefault(),w(N),C(X),j(!1)},z=a=>{i(a.id),p({name:a.name,price:a.price,stock:a.stock,description:a.description||"",discounts:a.discounts||[]}),u(!0)},K=()=>{i(null),p({...A,discounts:[]}),u(!1)},H=a=>{I(a)&&p({...o,price:a===""?0:M(a)})},J=a=>{a===""?p({...o,price:0}):M(a)<0&&(s(D.PRICE_MUST_BE_POSITIVE,"error"),p({...o,price:0}))},Q=a=>{I(a)&&p({...o,stock:a===""?0:M(a)})},G=a=>{const _=M(a);a===""?p({...o,stock:0}):_<0?(s(D.STOCK_MUST_BE_POSITIVE,"error"),p({...o,stock:0})):_>V&&(s(D.STOCK_EXCEEDS_MAX,"error"),p({...o,stock:V}))},Y=a=>{I(a)&&C({...N,discountValue:a===""?0:M(a)})},Z=()=>{const a=N.discountValue;N.discountType==="percentage"?a>100?(s(D.DISCOUNT_RATE_EXCEEDS_MAX,"error"),C({...N,discountValue:100})):a<0&&C({...N,discountValue:0}):a>q?(s(D.DISCOUNT_AMOUNT_EXCEEDS_MAX,"error"),C({...N,discountValue:q})):a<0&&C({...N,discountValue:0})};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>b("products"),className:"py-2 px-1 border-b-2 font-medium text-sm transition-colors "+(x==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"상품 관리"}),e.jsx("button",{onClick:()=>b("coupons"),className:"py-2 px-1 border-b-2 font-medium text-sm transition-colors "+(x==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"쿠폰 관리"})]})}),x==="products"?e.jsx(De,{products:t,showProductForm:l,editingProduct:g,productForm:o,onStartAdd:()=>{i("new"),p({...A,discounts:[]}),u(!0)},onStartEdit:z,onDelete:S,onSubmit:T,onCancel:K,onNameChange:a=>p({...o,name:a}),onDescriptionChange:a=>p({...o,description:a}),onPriceChange:H,onPriceBlur:J,onStockChange:Q,onStockBlur:G,onDiscountsChange:a=>p({...o,discounts:a})}):e.jsx(Pe,{coupons:m,showCouponForm:y,couponForm:N,onToggleForm:()=>j(!y),onDelete:v,onSubmit:O,onCancel:()=>j(!1),onNameChange:a=>C({...N,name:a}),onCodeChange:a=>C({...N,code:a.toUpperCase()}),onTypeChange:a=>C({...N,discountType:a}),onValueChange:Y,onValueBlur:Z})]})}function _e({searchTerm:s,onSearchChange:t}){return e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:s,onChange:r=>t(r.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})}function Me({isAdmin:s,searchTerm:t,cartLength:r,totalItemCount:n,onToggleAdmin:c,onSearchChange:m}){return e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&e.jsx(_e,{searchTerm:t,onSearchChange:m})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:c,className:"px-3 py-1.5 text-sm rounded transition-colors "+(s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"),children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&e.jsxs("div",{className:"relative",children:[e.jsx(ue,{}),r>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:n})]})]})]})})})}function Ae({notifications:s,onRemove:t}){return s.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:s.map(r=>e.jsxs("div",{className:"p-4 rounded-md shadow-md text-white flex justify-between items-center "+(r.type==="error"?"bg-red-600":r.type==="warning"?"bg-yellow-600":"bg-green-600"),children:[e.jsx("span",{className:"mr-2",children:r.message}),e.jsx("button",{onClick:()=>t(r.id),className:"text-white hover:text-gray-200",children:e.jsx(R,{})})]},r.id))})}const Ie=()=>{const{products:s}=U(),{cart:t,totalItemCount:r,selectedCoupon:n,addToCart:c,removeFromCart:m,updateQuantity:h,applyCoupon:f,clearCoupon:x,clearCart:b,calculateItemTotal:l,calculateCartTotal:u,getRemainingStock:y}=ae(s),[j,g]=d.useState(!1),[i,o]=d.useState([]),[p,N]=d.useState(""),C=te(p,oe),k=d.useCallback((S,w="success")=>{const v=Date.now().toString();o(T=>[...T,{id:v,message:S,type:w}]),setTimeout(()=>{o(T=>T.filter(O=>O.id!==v))},ce)},[]),P=d.useCallback(S=>{o(w=>w.filter(v=>v.id!==S))},[]);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ae,{notifications:i,onRemove:P}),e.jsx(Me,{isAdmin:j,searchTerm:p,cartLength:t.length,totalItemCount:r,onToggleAdmin:()=>g(!j),onSearchChange:N}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:j?e.jsx(Oe,{onNotification:k}):e.jsx(ke,{searchTerm:C,onNotification:k,cart:t,selectedCoupon:n,addToCart:c,removeFromCart:m,updateQuantity:h,applyCoupon:f,clearCoupon:x,clearCart:b,calculateItemTotal:l,calculateCartTotal:u,getRemainingStock:y})})]})};ee.createRoot(document.getElementById("root")).render(e.jsx(se.StrictMode,{children:e.jsx(Ie,{})}));
